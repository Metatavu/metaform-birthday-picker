!function(){"use strict";$.widget("custom.metaformBirthdayPicker",{options:{locale:"fi",order:["DAY","MONTH","YEAR"],inputClass:"form-control",inputContainerClass:"form-inline",labels:{DAY:"Päivä",MONTH:"Kuukausi",YEAR:"Vuosi"},maxAge:150},val:function(t){if(!t){var e=moment({year:this._getYearValue(),month:this._getMonthValue(),day:this._getDayValue()});return e.isValid()?e.toDate():null}var a=moment(t);a.isValid()?(this._setDayValue(a.date()),this._setMonthValue(a.month()),this._setYearValue(a.year())):console.error("Cannot set invalid date value"+t)},_create:function(){this.element.hide(),this.required=!!this.element.attr("required"),this.container=$("<div>").addClass(this.options.inputContainerClass);for(var t=0;t<this.options.order.length;t++)switch(this.options.order[t]){case"DAY":this.container.append(this._createDayInput());break;case"MONTH":this.container.append(this._createMonthInput());break;case"YEAR":this.container.append(this._createYearInput());break;default:console.error("Unknown birthday input type "+this.options.order[t])}this.element.after(this.container)},_getDayValue:function(){return this.container.find(".metaform-birtday-day-input").val()},_getMonthValue:function(){return this.container.find(".metaform-birtday-month-input").val()},_getYearValue:function(){return this.container.find(".metaform-birtday-year-input").val()},_setDayValue:function(t){return this.container.find(".metaform-birtday-day-input").val(t)},_setMonthValue:function(t){return this.container.find(".metaform-birtday-month-input").val(t)},_setYearValue:function(t){return this.container.find(".metaform-birtday-year-input").val(t)},_updateDisabledDates:function(t){this.container.find(".metaform-birtday-day-input").find("option").each(function(){$(this).val()>t?$(this).attr("disabled","disabled"):$(this).removeAttr("disabled")})},_createDayInput:function(){var t=$("<select>").addClass("metaform-birtday-day-input").addClass(this.options.inputClass);this.required&&t.attr("required","required"),t.append($("<option>").attr("value","").attr("disabled","disabled").text(this.options.labels.DAY));for(var e=1;e<=31;e++)t.append($("<option>").attr("value",e).text(e));return t.change(this._onInputComponentChange.bind(this)),t},_createMonthInput:function(){var t=moment.localeData(this.options.locale).months(),e=$("<select>").addClass("metaform-birtday-month-input").addClass(this.options.inputClass);this.required&&e.attr("required","required"),e.append($("<option>").attr("value","").attr("disabled","disabled").text(this.options.labels.MONTH));for(var a=0;a<t.length;a++)e.append($("<option>").attr("value",a).text(t[a]));return e.change(this._onYearOrMonthInputChange.bind(this)),e.change(this._onInputComponentChange.bind(this)),e},_createYearInput:function(){var t=(new Date).getFullYear(),e=$("<select>").addClass("metaform-birtday-year-input").addClass(this.options.inputClass);this.required&&e.attr("required","required"),e.append($("<option>").attr("value","").attr("disabled","disabled").text(this.options.labels.YEAR));for(var a=t;a>t-this.options.maxAge;a--)e.append($("<option>").attr("value",a).text(a));return e.change(this._onYearOrMonthInputChange.bind(this)),e.change(this._onInputComponentChange.bind(this)),e},_updateInputValidity:function(t){var e=t||"";this.container.find(".metaform-birtday-day-input")[0].setCustomValidity(e),this.container.find(".metaform-birtday-month-input")[0].setCustomValidity(e),this.container.find(".metaform-birtday-year-input")[0].setCustomValidity(e)},_onYearOrMonthInputChange:function(t){var e=this._getDayValue(),a=this._getMonthValue(),n=this._getYearValue()||(new Date).getFullYear();if(a){var i=moment({year:n,month:a}).daysInMonth();i<e&&this._setDayValue(""),this._updateDisabledDates(i)}},_onInputComponentChange:function(t){var e=moment({year:this._getYearValue(),month:this._getMonthValue(),day:this._getDayValue()}),a="Invalid birthday";e.isValid()&&(this.element.val(e.toDate()),a=""),this._updateInputValidity(a),this.element.trigger("change")}})}();